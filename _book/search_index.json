[["index.html", "BayPass 2.3: tutoriel de génomique dassociation adapté au séquençage en pool Résumé prérequis", " BayPass 2.3: tutoriel de génomique dassociation adapté au séquençage en pool Jérôme OLIVARES1 2023-06-17 Résumé Ce tutoriel détaille dune part la manière de générer les fichiers dentrées du logiciel BayPass à partir de données de séquençage en pool, dautre part le paramétrage optimal du logiciel BayPass et en fin propose une méthode dexploreration des résultats danalyses produits. Un pipeline danalyse mixant des packages sous Rstudio et des lignes de commandes Linux, est décrit afin de guider pas à pas lutilisateur tout au long du processus depuis les données brutes jusquà la liste finale de loci/variants candidats. Ce tutoriel est à destination des étudiants et des bioinformaticiens débutants. mots clefs Logiciel BayPass, séquençage en pool, GWAS, études dassociations pangénomiques, Rstudio. prérequis Les commandes décrites dans cet article ont été regroupées dans un fichier au format « R markdown » (Rmd) « Poolseq_pipeline.Rmd » librement téléchargeable à ladresse : https://github.com/Jolivares-INRAE/Download. Ce tutoriel est conçu pour décrire pas à pas les différentes étapes du fichier Rmd et permettre à lutilisateur de les exécuter en parallèle. Lutilisateur devra avoir une connaissance basique du logiciel Rstudio et être capable décrire et lancer des scripts sur un cluster de calcul. Les commandes ont été rédigées sous Rstudio version 1.4.1106 couplé à R 64 bits version 4.0.5. avec toutes les librairies nécessaires à jour (Capture 1) et dans lenvironnement bash/SLURM des clusters de calculs de la plateforme GenoToul de bioinformatique (GenoToul Bioinfo ). Dans le cas dune utilisation dans un autre environnement logiciel, lutilisateur devra probablement effectuer des adaptations du code. Bien que lessentiel des calculs de BayPass seront réalisés sur un cluster de calcul, certains de ses utilitaires seront utilisés en local sous Rstudio, la dernière version du logiciel sera donc téléchargée depuis ladresse http://www1.montpellier.inra.fr/CBGP/software/baypass/download.html et décompressée dans un répertoire local par lutilisateur. Dans tous les codes qui suivent lexpression « ~/path/ » sera à remplacer par les chemins personnels de lutilisateur. Le terme de chromosome sera utilisé en références aux appellations de contigs, scaffold, ou chromosomes qui correspondent aux séquences nucléotidiques du génome de référence, plus ou moins mature, qui sera utilisé. INRAE, UR-1115 PSH, 228 route de laérodrome, 84914 Avignon, France "],["résumé-1.html", "Résumé prérequis", " Résumé Ce tutoriel détaille dune part la manière de générer les fichiers dentrées du logiciel BayPass à partir de données de séquençage en pool, dautre part le paramétrage optimal du logiciel BayPass et en fin propose une méthode dexploreration des résultats danalyses produits. Un pipeline danalyse mixant des packages sous Rstudio et des lignes de commandes Linux, est décrit afin de guider pas à pas lutilisateur tout au long du processus depuis les données brutes jusquà la liste finale de loci/variants candidats. Ce tutoriel est à destination des étudiants et des bioinformaticiens débutants. mots clefs Logiciel BayPass, séquençage en pool, GWAS, études dassociations pangénomiques, Rstudio. prérequis Les commandes décrites dans cet article ont été regroupées dans un fichier au format « R markdown » (Rmd) « Poolseq_pipeline.Rmd » librement téléchargeable à ladresse : https://github.com/Jolivares-INRAE/Download. Ce tutoriel est conçu pour décrire pas à pas les différentes étapes du fichier Rmd et permettre à lutilisateur de les exécuter en parallèle. Lutilisateur devra avoir une connaissance basique du logiciel Rstudio et être capable décrire et lancer des scripts sur un cluster de calcul. Les commandes ont été rédigées sous Rstudio version 1.4.1106 couplé à R 64 bits version 4.0.5. avec toutes les librairies nécessaires à jour (Capture 1) et dans lenvironnement bash/SLURM des clusters de calculs de la plateforme GenoToul de bioinformatique (GenoToul Bioinfo ). Dans le cas dune utilisation dans un autre environnement logiciel, lutilisateur devra probablement effectuer des adaptations du code. Bien que lessentiel des calculs de BayPass seront réalisés sur un cluster de calcul, certains de ses utilitaires seront utilisés en local sous Rstudio, la dernière version du logiciel sera donc téléchargée depuis ladresse http://www1.montpellier.inra.fr/CBGP/software/baypass/download.html et décompressée dans un répertoire local par lutilisateur. Dans tous les codes qui suivent lexpression « ~/path/ » sera à remplacer par les chemins personnels de lutilisateur. Le terme de chromosome sera utilisé en références aux appellations de contigs, scaffold, ou chromosomes qui correspondent aux séquences nucléotidiques du génome de référence, plus ou moins mature, qui sera utilisé. "],["introduction.html", "Introduction", " Introduction Dans un contexte agronomique actuel de réduction de lutilisation des pesticides ou de réchauffement climatique, analyser et comprendre les bases génétiques de ladaptation des organismes aux méthodes de luttes qui leurs sont opposées ou à lévolution de leur environnement est un enjeu majeur des recherches de ces dernières années. Les études dassociations pangénomiques (GWAS en anglais pour genome-wide association study) adossées aux techniques de séquençage haut débit (NGS) permettant le séquençage de génome complet, sont un outil de choix pour ce type danalyse. Létude au niveau populationnel demandant le séquençage dun grand nombre dindividus, les couts danalyses étaient initialement très élevés et ces études étaient souvent réservées aux organismes dit modèles, humain en tête. Néanmoins il a été démontré depuis, que le séquençage en pool dindividus (poolseq) cest-à-dire en mélangeant de manière équimolaire lADN dun grand nombre dindividus (50 à 100) issus dune même population permettait non seulement de réduire drastiquement les couts puisquon ne réalise quun seul séquençage mais aussi que la découverte des points de mutations (SNP) et lestimation de leur fréquence allélique étaient souvent plus efficaces et précises (Futschik and Schlötterer 2010). Parmi les logiciels à même danalyser ces fréquences alléliques on compte Baypass (Gautier 2015) qui évalue par une approche baysienne, la différenciation des SNP en liaison avec une covariable environnementale en tenant compte de la structure et de la parenté entre les populations en estimant la covariance () des fréquences alléliques. Baypass 2.3 a la particularité supplémentaire de pouvoir calculer un contraste des fréquences alléliques entre deux groupes de populations caractérisés par un caractère binaire, sensible ou résistant par exemple. La documentation disponible de BayPass 2.3 décrit par le menu les algorithmes de fonctionnement et les différents paramètres du logiciel mais reste néanmoins, et assez logiquement, succincte sur les étapes en amont et en aval. A ma connaissance un seul tutoriel est disponible sur le web (Nielsen 2020) et décrit de manière plus détaillée la préparation des données brutes et lanalyse en mode « poolseq » de Baypass, mais il nécessite des bases quelque peu avancées de codage sous R et en environnement bash. Si les bio-informaticiens chevronnés ne rencontreront pas de difficultés particulières, il nen va pas forcément de même pour bon nombre dagents que les orientations des recherches associées à la baisse des coûts de séquençage ont aiguillé vers les voies de la génomique. Cet article a pour but de détailler les différentes étapes dune analyse de type GWAS/poolseq avec le logiciel BayPass 2.3 et déclairer les points qui sont habituellement peu explicités car considérés comme évident et se veut, au final, le plus proche possible de la citation de Talleyrand : « Si cela va sans le dire, cela ira encore mieux en le disant ». References "],["présentation-du-logiciel-baypass-2.html", "Présentation du logiciel BayPass 2.3 Présentation générale de lanalyse :", " Présentation du logiciel BayPass 2.3 Le logiciel BayPass est un logiciel de génomique des populations qui vise principalement à lidentification de marqueurs génétiques soumis à la sélection et/ou associés à des covariables spécifiques à la population (variables environnementales, phénotypiques, quantitatives, catégorielles). Par une approche baysienne il évalue une matrice  de covariance des fréquences alléliques des populations résultant de leur histoire démographique. Deux manières destimer ces fréquences alléliques sont disponibles soit en se basant sur les génotypes référence/mutant des individus analysés soit, lorsque lon active le « pool-seq mode », ces fréquences alléliques sont calculées en regard de la profondeur de séquençage (reads count) et pondérées par le nombre dindividus qui ont contribué à cette profondeur. Cest cette seconde approche que nous considérerons dans cet ouvrage. BayPass propose 3 modèles statistiques danalyse : Le Core Model Cest le modèle de base, il permet de calculer la matrice de covariance  et dattribuer une statistique de différenciation XtX à chaque SNP, et ainsi de scanner le génome pour identifier les régions génomiques différenciées entre les populations.Le XtX est une statistique analogue au Fst mais tient compte de la co-évolution des populations grace à la matrice . Le Standard Model Ce modèle, permet, lorsque lon fournit une ou plusieurs covariables (environnementales, phénotypiques), de calculer un facteur de Bayes, ou Bayes factor en anglais, (BF) pour chaque marqueur génétique représentant la force dassociation avec une covariable. Cest un modèle tout en un qui intègre le calcul des XtX et de la matrice , il est adapté au faible nombre de population (&lt; 15). LAuxiliairy Model Ce modèle a une approche différente dans le calcul de la statistique BF, sans entrer dans le détail il est plus adapté au grand nombre de population (&gt; 15), En contrepartie il nécessite que lon fournisse une matrice  déjà calculée par une analyse Core Model précédente, il recalcule alors les XtX et la statistique BF. Ces covariables évoquées doivent être distribuées en gradient entre les populations (différence de température, daltitude), en complément, dans le cas où la covariable étudiée serait purement binaire (sensible/résistant, gros/petit), les modèles Standard et Auxiliaire peuvent calculer une statistique C2 qui évalue le contraste de différence des fréquences alléliques de chaque marqueur entre 2 groupes de populations. Présentation générale de lanalyse : La figure 1 est une vision simplifiée des différentes étapes nécessaire à lanalyses de données poolseq. Ces étapes se déroulent soit dans lenvironnement Linux du cluster de calcul soit sur un ordinateur local sous Rstudio. La première étape part dun fichier dalignement au format « .bam » et consiste à effectuer une recherche de variants (variant calling) pour obtenir un fichier au format « .vcf » de tous les points de mutations ou SNP qui sont autant de marqueurs génétiques à analyser. Ce fichier .vcf sert dentrée au package « PoolFstat » qui va permettre de générer les fichiers nécessaires au bon fonctionnement de BayPass mais aussi de faire une première analyse des Fst entre populations par exemple. Ces fichiers dentrées pouvant contenir plusieurs millions de SNP, ils sont découpés en plusieurs dizaines de sous jeux de données afin de réduire les temps de calculs. Une fois que BayPass a analysé tous les sous jeux de données, lhomogénéité des résultats entre eux est analysée sous Rstudio et si tout est bon, les résultats peuvent être regroupés, filtrés et analysés afin de déterminer les marqueurs génétiques et les régions chromosomiques dintérêts. "],["section.html", " Présentation générale de lanalyse :", " Présentation générale de lanalyse : La figure 1 est une vision simplifiée des différentes étapes nécessaire à lanalyses de données poolseq. Ces étapes se déroulent soit dans lenvironnement Linux du cluster de calcul soit sur un ordinateur local sous Rstudio. La première étape part dun fichier dalignement au format « .bam » et consiste à effectuer une recherche de variants (variant calling) pour obtenir un fichier au format « .vcf » de tous les points de mutations ou SNP qui sont autant de marqueurs génétiques à analyser. Ce fichier .vcf sert dentrée au package « PoolFstat » qui va permettre de générer les fichiers nécessaires au bon fonctionnement de BayPass mais aussi de faire une première analyse des Fst entre populations par exemple. Ces fichiers dentrées pouvant contenir plusieurs millions de SNP, ils sont découpés en plusieurs dizaines de sous jeux de données afin de réduire les temps de calculs. Une fois que BayPass a analysé tous les sous jeux de données, lhomogénéité des résultats entre eux est analysée sous Rstudio et si tout est bon, les résultats peuvent être regroupés, filtrés et analysés afin de déterminer les marqueurs génétiques et les régions chromosomiques dintérêts. "],["footnotes-and-citations.html", "1 Footnotes and citations 1.1 Footnotes 1.2 Citations", " 1 Footnotes and citations 1.1 Footnotes Footnotes are put inside the square brackets after a caret ^[]. Like this one 2. 1.2 Citations Reference items in your bibliography file(s) using @key. For example, we are using the bookdown package (R-bookdown?) (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and knitr (xie2015?) (this citation was added manually in an external file book.bib). Note that the .bib files need to be listed in the index.Rmd with the YAML bibliography key. The RStudio Visual Markdown Editor can also make it easier to insert citations: https://rstudio.github.io/visual-markdown-editing/#/citations This is a footnote. "],["blocks.html", "2 Blocks 2.1 Equations 2.2 Theorems and proofs 2.3 Callout blocks", " 2 Blocks 2.1 Equations Here is an equation. \\[\\begin{equation} f\\left(k\\right) = \\binom{n}{k} p^k\\left(1-p\\right)^{n-k} \\tag{2.1} \\end{equation}\\] You may refer to using \\@ref(eq:binom), like see Equation (2.1). 2.2 Theorems and proofs Labeled theorems can be referenced in text using \\@ref(thm:tri), for example, check out this smart theorem 2.1. Theorem 2.1 For a right triangle, if \\(c\\) denotes the length of the hypotenuse and \\(a\\) and \\(b\\) denote the lengths of the other two sides, we have \\[a^2 + b^2 = c^2\\] Read more here https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html. 2.3 Callout blocks The R Markdown Cookbook provides more help on how to use custom blocks to design your own callouts: https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html "],["sharing-your-book.html", "3 Sharing your book 3.1 Publishing 3.2 404 pages 3.3 Metadata for sharing", " 3 Sharing your book 3.1 Publishing HTML books can be published online, see: https://bookdown.org/yihui/bookdown/publishing.html 3.2 404 pages By default, users will be directed to a 404 page if they try to access a webpage that cannot be found. If youd like to customize your 404 page instead of using the default, you may add either a _404.Rmd or _404.md file to your project root and use code and/or Markdown syntax. 3.3 Metadata for sharing Bookdown HTML books will provide HTML metadata for social sharing on platforms like Twitter, Facebook, and LinkedIn, using information you provide in the index.Rmd YAML. To setup, set the url for your book and the path to your cover-image file. Your books title and description are also used. This gitbook uses the same social sharing data across all chapters in your book- all links shared will look the same. Specify your books source repository on GitHub using the edit key under the configuration options in the _output.yml file, which allows users to suggest an edit by linking to a chapters source file. Read more about the features of this output format here: https://pkgs.rstudio.com/bookdown/reference/gitbook.html Or use: ?bookdown::gitbook "],["references.html", "References", " References "],["baypass-2.3-présentation..html", "4 BayPass 2.3 : présentation.", " 4 BayPass 2.3 : présentation. Le logiciel BayPass est un logiciel de génomique des populations qui vise principalement à lidentification de marqueurs génétiques soumis à la sélection et/ou associés à des covariables spécifiques à la population (variables environnementales, phénotypiques, quantitatives, catégorielles). Par une approche baysienne il évalue une matrice  de covariance des fréquences alléliques des populations résultant de leur histoire démographique. Deux manières destimer ces fréquences alléliques sont disponibles soit en se basant sur les génotypes référence/mutant des individus analysés soit, lorsque lon active le « pool-seq mode », ces fréquences alléliques sont calculées en regard de la profondeur de séquençage (reads count) et pondérées par le nombre dindividus qui ont contribué à cette profondeur. Cest cette seconde approche que nous considérerons dans cet article. BayPass propose 3 modèles statistiques danalyse : ### Le Core Model, est le modèle de base, il permet de calculer la matrice de covariance  et dattribuer une statistique de différenciation XtX à chaque SNP, et ainsi de scanner le génome pour identifier les régions différenciées sans autres informations. ### Le Standard Model, permet, lorsque lon fournit une ou plusieurs covariables (environnementales, phénotypiques), de calculer en plus une statistique BF (Bayes Factor) pour chaque marqueur génétique et chaque covariable. Cest un modèle tout en un qui intègre le calcul des XtX et de la matrice , il est adapté au faible nombre de population (&lt; 815). ### LAuxiliairy Model, a une approche différente dans le calcul de la statistique BF, sans entrer dans le détail il est plus adapté au grand nombre de population (&gt; 815)., En contrepartie ce modèle nécessite que lon fournisse une matrice  déjà calculé par une analyse Core Model, il recalcule alors les XtX et la statistique B. Ces covariables évoquées doivent être distribuées en gradient entre les populations (différence de température, daltitude), en complément, dans le cas où la covariable étudiée serait purement binaire (sensible/résistant, gros/petit), les modèles Standard et Auxiliaire peuvent calculer une statistique C2 qui évalue le contraste de différence des fréquences alléliques entre 2 groupes de populations. "],["parts.html", "5 Parts", " 5 Parts You can add parts to organize one or more book chapters together. Parts can be inserted at the top of an .Rmd file, before the first-level chapter heading in that same file. Add a numbered part: # (PART) Act one {-} (followed by # A chapter) Add an unnumbered part: # (PART\\*) Act one {-} (followed by # A chapter) Add an appendix as a special kind of un-numbered part: # (APPENDIX) Other stuff {-} (followed by # A chapter). Chapters in an appendix are prepended with letters instead of numbers. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
