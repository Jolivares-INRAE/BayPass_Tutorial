<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Baypass : les résultats | BayPass 2.3: tutoriel de génomique d’association adapté au séquençage en pool</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Baypass : les résultats | BayPass 2.3: tutoriel de génomique d’association adapté au séquençage en pool" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://jolivares-inrae.github.io/BayPass_Tutorial/C:/Users/Olivares/Documents/R/Git_Work/BayPass_Tutorial/_book/images/icone3.png" />
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="https://github.com/Jolivares-INRAE/BayPass_Tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Baypass : les résultats | BayPass 2.3: tutoriel de génomique d’association adapté au séquençage en pool" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="twitter:image" content="https://jolivares-inrae.github.io/BayPass_Tutorial/C:/Users/Olivares/Documents/R/Git_Work/BayPass_Tutorial/_book/images/icone3.png" />

<meta name="author" content="Jérôme OLIVARES" />


<meta name="date" content="2023-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="baypass-lanalyse-poolseq.html"/>
<link rel="next" href="références.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Résumé</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#mots-clefs"><i class="fa fa-check"></i>mots clefs</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prérequis"><i class="fa fa-check"></i>prérequis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="présentation-du-logiciel-baypass-2.html"><a href="présentation-du-logiciel-baypass-2.html"><i class="fa fa-check"></i>Présentation du logiciel BayPass 2.3</a>
<ul>
<li class="chapter" data-level="" data-path="présentation-du-logiciel-baypass-2.html"><a href="présentation-du-logiciel-baypass-2.html#présentation-générale-de-lanalyse"><i class="fa fa-check"></i>Présentation générale de l’analyse :</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="données-brutes.html"><a href="données-brutes.html"><i class="fa fa-check"></i>Données brutes</a>
<ul>
<li class="chapter" data-level="" data-path="données-brutes.html"><a href="données-brutes.html#obtention-dun-fichier-poolseq.vcf"><i class="fa fa-check"></i>Obtention d’un fichier Poolseq.vcf :</a></li>
<li class="chapter" data-level="" data-path="données-brutes.html"><a href="données-brutes.html#filtrage-des-données-brutes"><i class="fa fa-check"></i>Filtrage des données brutes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conversion-du-pooldata-en-fichiers-dentrées-pour-baypass.html"><a href="conversion-du-pooldata-en-fichiers-dentrées-pour-baypass.html"><i class="fa fa-check"></i>Conversion du pooldata en fichiers d’entrées pour BayPass</a>
<ul>
<li class="chapter" data-level="" data-path="conversion-du-pooldata-en-fichiers-dentrées-pour-baypass.html"><a href="conversion-du-pooldata-en-fichiers-dentrées-pour-baypass.html#design-de-lanalyse-baypass"><i class="fa fa-check"></i>Design de l’analyse BayPass</a></li>
<li class="chapter" data-level="" data-path="conversion-du-pooldata-en-fichiers-dentrées-pour-baypass.html"><a href="conversion-du-pooldata-en-fichiers-dentrées-pour-baypass.html#subsampling"><i class="fa fa-check"></i>Subsampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="baypass-lanalyse-poolseq.html"><a href="baypass-lanalyse-poolseq.html"><i class="fa fa-check"></i>Baypass : l’analyse poolseq</a></li>
<li class="chapter" data-level="" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html"><i class="fa fa-check"></i>Baypass : les résultats</a>
<ul>
<li class="chapter" data-level="" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html#validation-des-données-analysées"><i class="fa fa-check"></i>Validation des données analysées</a></li>
<li class="chapter" data-level="" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html#concaténation-des-résultats"><i class="fa fa-check"></i>Concaténation des résultats</a>
<ul>
<li class="chapter" data-level="" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html#fst-en-fenêtre-glissante"><i class="fa fa-check"></i>Fst en fenêtre glissante</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html#An2"><i class="fa fa-check"></i>Annexe 2</a>
<ul>
<li class="chapter" data-level="0.0.1" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html#conversion-de-la-matrice-svd-en-graphique-ggplot."><i class="fa fa-check"></i><b>0.0.1</b> Conversion de la matrice SVD en graphique ggplot.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html#An3"><i class="fa fa-check"></i>Annexe 3</a>
<ul>
<li class="chapter" data-level="0.0.2" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html#concaténages-des-résultats-betai-et-contrastes."><i class="fa fa-check"></i><b>0.0.2</b> Concaténages des résultats Betai et contrastes.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BayPass 2.3: tutoriel de génomique d’association adapté au séquençage en pool</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="baypass-les-résultats" class="section level1 unnumbered hasAnchor">
<h1>Baypass : les résultats<a href="baypass-les-résultats.html#baypass-les-résultats" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="validation-des-données-analysées" class="section level2 unnumbered hasAnchor">
<h2>Validation des données analysées<a href="baypass-les-résultats.html#validation-des-données-analysées" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Chaque sous jeu de données analysé va produire 8 fichiers de résultats avec des extensions différentes, un premier contrôle visuel utile est de vérifier que tous les fichiers partageant la même extension soient de taille identique en kilo ou méga-octets. Des différences manifestes sont signes de problèmes lors de l’analyse (crash, disque plein…) conduisant à des fichiers incomplets. Ceux qui vont focaliser notre attention en premier lieu sont les fichiers <strong><em>mat_omega.out</em></strong> qui contiennent la matrice Omega (Ω) de covariance des fréquences alléliques des populations qui est calculée à chaque analyse. Avant de regrouper les résultats, il faut s’assurer que chaque fichier du sous jeu de données a été analysé de la même manière que tous les autres, en comparant les matrices Ω entre elles.
Cette comparaison se fait en évaluant un indice de distance FMD (Förstner &amp; Moonen, 2003) entre matrices ; plus la distance sera faible (idéalement inférieure à 1) plus les matrices, donc les analyses, seront comparables.(Chunk <a href="baypass-les-résultats.html#exr:chunk4">4</a>)</p>
<div class="exercise">
<p><span id="exr:chunk4" class="exercise"><strong>Chunk 4  </strong></span><span style="color:darkgreen">Comparaison des matrices Ω</span></p>
</div>
<p style="font-family: calibri; font-size:11pt; font-style:italic; color:darkgreen">
Les fichiers de matrice sont copiés dans un dossier local puis comparés deux à deux par la fonction <strong><em>fmd.dist</em></strong> des utilitaires de BayPass pour évaluer leur distances.<br>
Une heatmap et une décomposition en valeurs singulières de la dernière matrice sont alors affichées.<br>
</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="baypass-les-résultats.html#cb10-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;/../baypass_utils.R&quot;</span>)</span>
<span id="cb10-2"><a href="baypass-les-résultats.html#cb10-2" tabindex="-1"></a>prefix <span class="ot">&lt;-</span> <span class="st">&quot;project.sub&quot;</span></span>
<span id="cb10-3"><a href="baypass-les-résultats.html#cb10-3" tabindex="-1"></a><span class="co">#liste et compte les matrices Ω du répertoire &quot;path&quot;</span></span>
<span id="cb10-4"><a href="baypass-les-résultats.html#cb10-4" tabindex="-1"></a>path_Omega <span class="ot">&lt;-</span> <span class="st">&quot;/../Omega_files/&quot;</span></span>
<span id="cb10-5"><a href="baypass-les-résultats.html#cb10-5" tabindex="-1"></a>listMatrix <span class="ot">&lt;-</span> <span class="fu">list.files</span>(path_Omega, <span class="at">pattern=</span><span class="st">&quot;mat_omega.out&quot;</span>)</span>
<span id="cb10-6"><a href="baypass-les-résultats.html#cb10-6" tabindex="-1"></a>nMatrix<span class="ot">&lt;-</span><span class="fu">length</span>(listMatrix)</span>
<span id="cb10-7"><a href="baypass-les-résultats.html#cb10-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Nbr matrix files =&quot;</span>, nMatrix, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-8"><a href="baypass-les-résultats.html#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="baypass-les-résultats.html#cb10-9" tabindex="-1"></a><span class="co">#boucle sur toutes les matrices, calcule les distances FMD en pairwise et stocke le résultat</span></span>
<span id="cb10-10"><a href="baypass-les-résultats.html#cb10-10" tabindex="-1"></a>ListFMD<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb10-11"><a href="baypass-les-résultats.html#cb10-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nMatrix) <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nMatrix) <span class="cf">if</span>(i<span class="sc">!=</span>j) {</span>
<span id="cb10-12"><a href="baypass-les-résultats.html#cb10-12" tabindex="-1"></a>omegaA<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="fu">paste</span>(path_Omega, prefix, i,<span class="st">&quot;_mat_omega.out&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)))</span>
<span id="cb10-13"><a href="baypass-les-résultats.html#cb10-13" tabindex="-1"></a>omegaB<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="fu">paste</span>(path_Omega, prefix, j,<span class="st">&quot;_mat_omega.out&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)))</span>
<span id="cb10-14"><a href="baypass-les-résultats.html#cb10-14" tabindex="-1"></a>FMD <span class="ot">&lt;-</span> <span class="fu">fmd.dist</span>(omegaA, omegaB)</span>
<span id="cb10-15"><a href="baypass-les-résultats.html#cb10-15" tabindex="-1"></a>ListFMD <span class="ot">&lt;-</span> <span class="fu">c</span>(ListFMD,FMD)</span>
<span id="cb10-16"><a href="baypass-les-résultats.html#cb10-16" tabindex="-1"></a>}</span>
<span id="cb10-17"><a href="baypass-les-résultats.html#cb10-17" tabindex="-1"></a></span>
<span id="cb10-18"><a href="baypass-les-résultats.html#cb10-18" tabindex="-1"></a><span class="co">#calcule la moyenne et la sd de toutes les distances FMD</span></span>
<span id="cb10-19"><a href="baypass-les-résultats.html#cb10-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;FMD mean =&quot;</span>, <span class="fu">mean</span>(ListFMD), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-20"><a href="baypass-les-résultats.html#cb10-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;FMD sd =&quot;</span> , <span class="fu">sd</span>(ListFMD), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-21"><a href="baypass-les-résultats.html#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="baypass-les-résultats.html#cb10-22" tabindex="-1"></a><span class="co">#heatmap de la dernière matrice Ω.</span></span>
<span id="cb10-23"><a href="baypass-les-résultats.html#cb10-23" tabindex="-1"></a><span class="fu">colnames</span>(omegaB) <span class="ot">&lt;-</span><span class="fu">c</span>(pnames)</span>
<span id="cb10-24"><a href="baypass-les-résultats.html#cb10-24" tabindex="-1"></a><span class="fu">rownames</span>(omegaB) <span class="ot">&lt;-</span><span class="fu">c</span>(pnames)</span>
<span id="cb10-25"><a href="baypass-les-résultats.html#cb10-25" tabindex="-1"></a>cor.mat<span class="ot">=</span><span class="fu">cov2cor</span>(omegaB)</span>
<span id="cb10-26"><a href="baypass-les-résultats.html#cb10-26" tabindex="-1"></a><span class="co">#heatmap des liens génétiques entre population</span></span>
<span id="cb10-27"><a href="baypass-les-résultats.html#cb10-27" tabindex="-1"></a>cim_color <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Blues&quot;</span>)))(<span class="dv">16</span>)</span>
<span id="cb10-28"><a href="baypass-les-résultats.html#cb10-28" tabindex="-1"></a><span class="fu">cim</span>(cor.mat, <span class="at">color =</span> cim_color, <span class="at">symkey =</span> <span class="cn">FALSE</span>, <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="at">title =</span> <span class="st">&quot;Correlation map based on last &quot;</span><span class="sc">~</span><span class="fu">hat</span>(Omega))</span>
<span id="cb10-29"><a href="baypass-les-résultats.html#cb10-29" tabindex="-1"></a><span class="co">#SVD de la dernière matrice Ω.</span></span>
<span id="cb10-30"><a href="baypass-les-résultats.html#cb10-30" tabindex="-1"></a>SVD_omega<span class="ot">&lt;-</span><span class="fu">plot.omega</span>(<span class="at">omega=</span>omegaB, <span class="at">pop.names=</span>pnames, <span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Singular Value Decomposition of last &quot;</span> <span class="sc">*</span> <span class="er">~</span><span class="fu">hat</span>(Omega)), <span class="at">pos=</span><span class="dv">3</span>)</span>
<span id="cb10-31"><a href="baypass-les-résultats.html#cb10-31" tabindex="-1"></a>SVD_omega</span></code></pre></div>
<p>Une fois la moyenne des FMD calculées il est possible de visualiser les liens génétiques entre populations représentés par la matrice Ω par un plot en heatmap ainsi que par la décomposition en valeurs singulières (SVD) d’une matrice prise au hasard.Un exemple de script pour convertir une SVD en plot ggplot2 beaucoup plus maniable et paramétrable pour une publication par exemple est donné en <a href="baypass-les-résultats.html#An2">Annexe 2</a>
Cette matrice SVD représente les distances génétiques des populations analysées.</p>
</div>
<div id="concaténation-des-résultats" class="section level2 unnumbered hasAnchor">
<h2>Concaténation des résultats<a href="baypass-les-résultats.html#concaténation-des-résultats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Une fois la reproductibilité des analyses vérifiées, il faut concaténer tous les fichiers de résultats, l’idée étant de faire le lien entre chaque fichier de résultat et son fichier de position <strong><em>snpdet.sub</em></strong> correspondant puis de les concaténer les uns aux autres. Les fichiers avec l’extension **__summary_pi_xtx.out_** contiennent les resultats liés à la statistique de differenciation <strong><em>XtX</em></strong>, le script (Script <a href="baypass-les-résultats.html#exm:script5">5</a>) est un exemple de script bash adapté à ce type de fichier.</p>
<div class="example">
<p><span id="exm:script5" class="example"><strong>Script 5  </strong></span><span style="color:darkgreen">Exemple d’un script bash pour concaténer les résultats <em>XtX</em>.</span></p>
</div>
<p style="font-family:calibri; font-size:11pt; font-style:italic; color:darkgreen">
Un boucle permet de coller chaque fichier résultat à son fichier snpdet correspondant(même numéro de subset “i”), le fichier obtenu est trié et l’entête reconstruite.
</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="baypass-les-résultats.html#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="baypass-les-résultats.html#cb11-2" tabindex="-1"></a><span class="va">Snpdet_path</span><span class="op">=</span><span class="st">&#39;/../BayPass/Input/&#39;</span></span>
<span id="cb11-3"><a href="baypass-les-résultats.html#cb11-3" tabindex="-1"></a><span class="va">My_prefix</span><span class="op">=</span><span class="st">&#39;project_STD.sub&#39;</span></span>
<span id="cb11-4"><a href="baypass-les-résultats.html#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="baypass-les-résultats.html#cb11-5" tabindex="-1"></a><span class="co">#on boucle sur tous les sous fichiers</span></span>
<span id="cb11-6"><a href="baypass-les-résultats.html#cb11-6" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">5</span><span class="dt">}</span></span>
<span id="cb11-7"><a href="baypass-les-résultats.html#cb11-7" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb11-8"><a href="baypass-les-résultats.html#cb11-8" tabindex="-1"></a><span class="va">file1</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$Snpdet_path</span><span class="st">/snpdet.sub&quot;&quot;</span><span class="va">$i</span><span class="st">&quot;&quot;&quot;</span><span class="va">)</span></span>
<span id="cb11-9"><a href="baypass-les-résultats.html#cb11-9" tabindex="-1"></a><span class="va">file2</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$My_prefix</span><span class="st">&quot;&quot;</span><span class="va">$i</span><span class="st">&quot;&quot;_summary_pi_xtx.out&quot;</span><span class="va">)</span></span>
<span id="cb11-10"><a href="baypass-les-résultats.html#cb11-10" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&quot;s/[[:space:]]\+/ /g&quot;</span> <span class="va">$file1</span> <span class="op">&gt;</span> SubSNP.x                          <span class="co">#on remplace tous les séparateurs par tabulation, ça évite les bugs</span></span>
<span id="cb11-11"><a href="baypass-les-résultats.html#cb11-11" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&quot;s/[[:space:]]\+/ /g&quot;</span> <span class="va">$file2</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-v</span> <span class="st">&quot;MRK&quot;</span> <span class="at">-</span> <span class="op">&gt;</span> SubData.x                   <span class="co">#on prend tout sauf l&#39;entête</span></span>
<span id="cb11-12"><a href="baypass-les-résultats.html#cb11-12" tabindex="-1"></a><span class="fu">paste</span> SubSNP.x SubData.x <span class="at">-</span> <span class="op">&gt;&gt;</span> tmp.xtx.merged                        <span class="co">#on colle/incrémente dans un nouveau fichier</span></span>
<span id="cb11-13"><a href="baypass-les-résultats.html#cb11-13" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb11-14"><a href="baypass-les-résultats.html#cb11-14" tabindex="-1"></a><span class="co">#on tri par chromosome et position</span></span>
<span id="cb11-15"><a href="baypass-les-résultats.html#cb11-15" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{for (i=1;i&lt;=NF;i++) if ($i+0 == $i &amp;&amp; $i ~ /e/) $2 = sprintf(&quot;%.0f&quot;, $i)} 1&#39;</span> tmp.xtx.merged <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-k1,1</span> <span class="at">-k2,2n</span> <span class="at">-</span> <span class="op">&gt;</span> 8pops_M-chr1-Core.xtx     </span>
<span id="cb11-16"><a href="baypass-les-résultats.html#cb11-16" tabindex="-1"></a></span>
<span id="cb11-17"><a href="baypass-les-résultats.html#cb11-17" tabindex="-1"></a><span class="co">#on supprime les fichiers tmp</span></span>
<span id="cb11-18"><a href="baypass-les-résultats.html#cb11-18" tabindex="-1"></a><span class="fu">rm</span> tmp.xtx.merged</span>
<span id="cb11-19"><a href="baypass-les-résultats.html#cb11-19" tabindex="-1"></a><span class="fu">rm</span> SubSNP.x</span>
<span id="cb11-20"><a href="baypass-les-résultats.html#cb11-20" tabindex="-1"></a><span class="fu">rm</span> SubData.x</span>
<span id="cb11-21"><a href="baypass-les-résultats.html#cb11-21" tabindex="-1"></a></span>
<span id="cb11-22"><a href="baypass-les-résultats.html#cb11-22" tabindex="-1"></a><span class="co">#on insère l&#39;entête du fichier</span></span>
<span id="cb11-23"><a href="baypass-les-résultats.html#cb11-23" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;1i chr pos All1 All2 MRK M_P SD_P M_XtX SD_XtX XtXst log10(1/pval)&#39;</span> 8pops_M-chr1-Core.xtx</span>
<span id="cb11-24"><a href="baypass-les-résultats.html#cb11-24" tabindex="-1"></a><span class="kw">```</span><span class="ex">Un</span> exemple de script bash est disponible en [Annexe 3]<span class="er">(</span><span class="co">#An3) pour les fichiers avec l&#39;extension </span></span>
<span id="cb11-25"><a href="baypass-les-résultats.html#cb11-25" tabindex="-1"></a></span>
<span id="cb11-26"><a href="baypass-les-résultats.html#cb11-26" tabindex="-1"></a><span class="op">&lt;</span>!--chapter:end:05-Validation.Rmd--<span class="op">&gt;</span></span>
<span id="cb11-27"><a href="baypass-les-résultats.html#cb11-27" tabindex="-1"></a></span>
<span id="cb11-28"><a href="baypass-les-résultats.html#cb11-28" tabindex="-1"></a><span class="co"># Annexes {-}</span></span>
<span id="cb11-29"><a href="baypass-les-résultats.html#cb11-29" tabindex="-1"></a></span>
<span id="cb11-30"><a href="baypass-les-résultats.html#cb11-30" tabindex="-1"></a><span class="co">## Annexe 1 {-#An1}</span></span>
<span id="cb11-31"><a href="baypass-les-résultats.html#cb11-31" tabindex="-1"></a></span>
<span id="cb11-32"><a href="baypass-les-résultats.html#cb11-32" tabindex="-1"></a><span class="ex">Le</span> package R <span class="pp">**</span>_poolfstat_<span class="pp">**</span> peut être utilisé pour calculer diverses statistiques utilisées dans les études de génomique des populations, ces outils sont décrits et exemplifiés dans la vignette de <span class="pp">**</span>_poolfstat_<span class="pp">**</span> : <span class="er">(</span><span class="ex">https://cran.r-project.org/web/packages/poolfstat/vignettes/vignette.pdf</span><span class="kw">)</span><span class="ex">,</span> parmis ceux-ci on trouve l<span class="st">&#39;analyse des Fst.</span></span>
<span id="cb11-33"><a href="baypass-les-résultats.html#cb11-33" tabindex="-1"></a></span>
<span id="cb11-34"><a href="baypass-les-résultats.html#cb11-34" tabindex="-1"></a><span class="st">### Pairwise {-}</span></span>
<span id="cb11-35"><a href="baypass-les-résultats.html#cb11-35" tabindex="-1"></a><span class="st">Calcul des Fst entre les populations deux à deux (pairwise) afin de visualiser la proximité génétique entre populations.</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="baypass-les-résultats.html#cb12-1" tabindex="-1"></a><span class="co">#Calcul des pairwise Fst </span></span>
<span id="cb12-2"><a href="baypass-les-résultats.html#cb12-2" tabindex="-1"></a>PairWise.fst <span class="ot">&lt;-</span> <span class="fu">compute.pairwiseFST</span>(pooldata, <span class="at">method =</span> <span class="st">&quot;Anova&quot;</span>, <span class="at">min.cov.per.pool =</span> <span class="dv">4</span>, <span class="at">max.cov.per.pool =</span> <span class="fl">1e+06</span>, <span class="at">min.maf =</span> <span class="fl">0.05</span>, <span class="at">output.snp.values =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-3"><a href="baypass-les-résultats.html#cb12-3" tabindex="-1"></a><span class="co">#conversion en matrice de distance</span></span>
<span id="cb12-4"><a href="baypass-les-résultats.html#cb12-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="fu">t</span>(PairWise.fst<span class="sc">@</span>PairwiseFSTmatrix)))</span>
<span id="cb12-5"><a href="baypass-les-résultats.html#cb12-5" tabindex="-1"></a><span class="co">#heatmap</span></span>
<span id="cb12-6"><a href="baypass-les-résultats.html#cb12-6" tabindex="-1"></a>cim_color <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Reds&quot;</span>)))(<span class="dv">9</span>)</span>
<span id="cb12-7"><a href="baypass-les-résultats.html#cb12-7" tabindex="-1"></a><span class="fu">cim</span>(df, <span class="at">color =</span> cim_color, <span class="at">symkey =</span> <span class="cn">FALSE</span>, <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>),  <span class="at">title =</span> <span class="st">&quot;heatmap des pairwise Fst entre les populations&quot;</span>)</span></code></pre></div>
<p>On peut aussi calculer et plotter des Fst multi-locus en balayant le génome avec une fenêtre glissante de SNP consécutifs et un chevauchement d’une demi fenêtre, une région génomique très différenciée apparaitra sous la forme d’une éruption de points colorés.</p>
<div id="fst-en-fenêtre-glissante" class="section level3 unnumbered hasAnchor">
<h3>Fst en fenêtre glissante<a href="baypass-les-résultats.html#fst-en-fenêtre-glissante" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="baypass-les-résultats.html#cb13-1" tabindex="-1"></a><span class="co">#calcul des Fst avec une fenêtre glissante de 100 SNP consécutifs .</span></span>
<span id="cb13-2"><a href="baypass-les-résultats.html#cb13-2" tabindex="-1"></a>Multi.Loc.fst <span class="ot">&lt;-</span> <span class="fu">computeFST</span>(pooldata, <span class="at">method =</span> <span class="st">&quot;Anova&quot;</span>, <span class="at">sliding.window.size =</span> <span class="dv">100</span>)</span>
<span id="cb13-3"><a href="baypass-les-résultats.html#cb13-3" tabindex="-1"></a><span class="co">#conversion en objet data frame</span></span>
<span id="cb13-4"><a href="baypass-les-résultats.html#cb13-4" tabindex="-1"></a>df.fst<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(Multi.Loc.fst<span class="sc">$</span>sliding.windows.fst, <span class="at">h=</span>T)</span>
<span id="cb13-5"><a href="baypass-les-résultats.html#cb13-5" tabindex="-1"></a><span class="co">#plot.</span></span>
<span id="cb13-6"><a href="baypass-les-résultats.html#cb13-6" tabindex="-1"></a>Fst.plot <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df.fst, <span class="fu">aes</span>(<span class="at">x=</span>CumulatedPosition<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">y=</span>MultiLocusFst)) <span class="sc">+</span></span>
<span id="cb13-7"><a href="baypass-les-résultats.html#cb13-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Chr), <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="baypass-les-résultats.html#cb13-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fst en fenêtres glissantes&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-9"><a href="baypass-les-résultats.html#cb13-9" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span>Multi.Loc.fst<span class="sc">$</span>FST,<span class="at">lty=</span><span class="dv">2</span>) <span class="co">#le seuil indique la Fst globale estimée à l&#39;échelle du génome</span></span>
<span id="cb13-10"><a href="baypass-les-résultats.html#cb13-10" tabindex="-1"></a>Fst.plot <span class="sc">+</span> <span class="fu">scale_x_continuous</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb13-11"><a href="baypass-les-résultats.html#cb13-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb13-12"><a href="baypass-les-résultats.html#cb13-12" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Chr, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>, <span class="at">strip.position =</span><span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>)) <span class="co">#affichage des chromosomes en grille</span></span></code></pre></div>
</div>
</div>
<div id="An2" class="section level2 unnumbered hasAnchor">
<h2>Annexe 2<a href="baypass-les-résultats.html#An2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="conversion-de-la-matrice-svd-en-graphique-ggplot." class="section level3 hasAnchor" number="0.0.1">
<h3><span class="header-section-number">0.0.1</span> Conversion de la matrice SVD en graphique ggplot.<a href="baypass-les-résultats.html#conversion-de-la-matrice-svd-en-graphique-ggplot." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il peut être intéressant de convertir la SVD en graphique ggplot, afin d’avoir la main sur tous les aspects cosmétiques en vue d’une publication par exemple.
Le principe consiste à créer une table dans laquelle on intègre les informations à ploter (noms, phenotype, couleurs) ainsi que les les 2 premiers vecteurs propres (eigen vector) et leur variance, de la matrice SVD.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="baypass-les-résultats.html#cb14-1" tabindex="-1"></a><span class="co"># définition des phenotypes, origines, noms</span></span>
<span id="cb14-2"><a href="baypass-les-résultats.html#cb14-2" tabindex="-1"></a>pheno <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39;Susceptible&#39;</span>,   <span class="st">&#39;Susceptible&#39;</span>,  <span class="st">&#39;Susceptible&#39;</span>, <span class="st">&#39;Susceptible&#39;</span>, <span class="st">&#39;Susceptible&#39;</span>, <span class="st">&#39;Susceptible&#39;</span>, <span class="st">&#39;Resistant&#39;</span>, <span class="st">&#39;Resistant&#39;</span>, <span class="st">&#39;Resistant&#39;</span>, <span class="st">&#39;Resistant&#39;</span>, <span class="st">&#39;Resistant&#39;</span>,<span class="st">&#39;Resistant&#39;</span>,<span class="st">&#39;Resistant&#39;</span>))</span>
<span id="cb14-3"><a href="baypass-les-résultats.html#cb14-3" tabindex="-1"></a>geo <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39;SE&#39;</span>,   <span class="st">&#39;SE&#39;</span>,  <span class="st">&#39;SO&#39;</span>, <span class="st">&#39;NO&#39;</span>,   <span class="st">&#39;NO&#39;</span>,  <span class="st">&#39;IT&#39;</span>, <span class="st">&#39;SO&#39;</span>,   <span class="st">&#39;NO&#39;</span>,  <span class="st">&#39;SE&#39;</span>,<span class="st">&#39;NO&#39;</span>,<span class="st">&#39;NO&#39;</span>,<span class="st">&#39;NO&#39;</span>,<span class="st">&#39;IT&#39;</span>))</span>
<span id="cb14-4"><a href="baypass-les-résultats.html#cb14-4" tabindex="-1"></a>nomsU<span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39; &#39;</span>,   <span class="st">&#39;SE-S-02&#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39;&#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>))</span>
<span id="cb14-5"><a href="baypass-les-résultats.html#cb14-5" tabindex="-1"></a>nomsL<span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39;NO-S-02&#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39;IT-S-01&#39;</span>, <span class="st">&#39;SO-R-01&#39;</span>,   <span class="st">&#39;NO-R-04&#39;</span>,  <span class="st">&#39;SE-R-01&#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39;IT-R-01&#39;</span>))</span>
<span id="cb14-6"><a href="baypass-les-résultats.html#cb14-6" tabindex="-1"></a>nomsR<span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39;SE-S-01&#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39;SO-S-01&#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39;NO-S-01&#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>,<span class="st">&#39; &#39;</span>))</span>
<span id="cb14-7"><a href="baypass-les-résultats.html#cb14-7" tabindex="-1"></a>nomsN1<span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39;NO-R-01&#39;</span>, <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>))</span>
<span id="cb14-8"><a href="baypass-les-résultats.html#cb14-8" tabindex="-1"></a>nomsN2<span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>, <span class="st">&#39;NO-R-02&#39;</span>, <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>))</span>
<span id="cb14-9"><a href="baypass-les-résultats.html#cb14-9" tabindex="-1"></a>nomsN3<span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>,   <span class="st">&#39; &#39;</span>,  <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>, <span class="st">&#39; &#39;</span>, <span class="st">&#39;NO-R-03&#39;</span>, <span class="st">&#39; &#39;</span>))</span>
<span id="cb14-10"><a href="baypass-les-résultats.html#cb14-10" tabindex="-1"></a>pos<span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39;R&#39;</span>,   <span class="st">&#39;T&#39;</span>,  <span class="st">&#39;R&#39;</span>, <span class="st">&#39;T&#39;</span>,   <span class="st">&#39;R&#39;</span>,  <span class="st">&#39;T&#39;</span>, <span class="st">&#39;R&#39;</span>,   <span class="st">&#39;R&#39;</span>,  <span class="st">&#39;T&#39;</span>,<span class="st">&#39;R&#39;</span>,<span class="st">&#39;R&#39;</span>,<span class="st">&#39;R&#39;</span>,<span class="st">&#39;R&#39;</span>))</span>
<span id="cb14-11"><a href="baypass-les-résultats.html#cb14-11" tabindex="-1"></a>col_geo<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#ffc100&quot;</span>,   <span class="st">&quot;#ffc100&quot;</span>,  <span class="st">&quot;#69ff27&quot;</span>, <span class="st">&quot;#00b0f0&quot;</span>, <span class="st">&quot;#00b0f0&quot;</span>, <span class="st">&quot;#7030a0&quot;</span>, <span class="st">&quot;#69ff27&quot;</span>, <span class="st">&quot;#00b0f0&quot;</span>,  <span class="st">&quot;#ffc100&quot;</span>,<span class="st">&quot;#00b0f0&quot;</span>,<span class="st">&quot;#00b0f0&quot;</span>,<span class="st">&quot;#00b0f0&quot;</span>,<span class="st">&quot;#7030a0&quot;</span>)</span>
<span id="cb14-12"><a href="baypass-les-résultats.html#cb14-12" tabindex="-1"></a><span class="co"># convertit en data.frame</span></span>
<span id="cb14-13"><a href="baypass-les-résultats.html#cb14-13" tabindex="-1"></a>tab_SVD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sample.id =</span> pnames,</span>
<span id="cb14-14"><a href="baypass-les-résultats.html#cb14-14" tabindex="-1"></a>    <span class="at">phenotype =</span> <span class="fu">factor</span>(pheno),</span>
<span id="cb14-15"><a href="baypass-les-résultats.html#cb14-15" tabindex="-1"></a>    <span class="at">region =</span> <span class="fu">factor</span>(geo),</span>
<span id="cb14-16"><a href="baypass-les-résultats.html#cb14-16" tabindex="-1"></a>    <span class="co">#noms = factor(noms),</span></span>
<span id="cb14-17"><a href="baypass-les-résultats.html#cb14-17" tabindex="-1"></a>    <span class="at">noms_bis =</span> <span class="fu">factor</span>(noms_bis),</span>
<span id="cb14-18"><a href="baypass-les-résultats.html#cb14-18" tabindex="-1"></a>    <span class="at">nomsUp =</span> <span class="fu">factor</span>(nomsU),</span>
<span id="cb14-19"><a href="baypass-les-résultats.html#cb14-19" tabindex="-1"></a>    <span class="at">nomsLeft =</span> <span class="fu">factor</span>(nomsL),</span>
<span id="cb14-20"><a href="baypass-les-résultats.html#cb14-20" tabindex="-1"></a>    <span class="at">nomsRight =</span> <span class="fu">factor</span>(nomsR),</span>
<span id="cb14-21"><a href="baypass-les-résultats.html#cb14-21" tabindex="-1"></a>    <span class="at">nomsN1 =</span> <span class="fu">factor</span>(nomsN1),</span>
<span id="cb14-22"><a href="baypass-les-résultats.html#cb14-22" tabindex="-1"></a>    <span class="at">nomsN2 =</span> <span class="fu">factor</span>(nomsN2),</span>
<span id="cb14-23"><a href="baypass-les-résultats.html#cb14-23" tabindex="-1"></a>    <span class="at">nomsN3 =</span> <span class="fu">factor</span>(nomsN3),</span>
<span id="cb14-24"><a href="baypass-les-résultats.html#cb14-24" tabindex="-1"></a>    <span class="at">colPop=</span>col_geo,</span>
<span id="cb14-25"><a href="baypass-les-résultats.html#cb14-25" tabindex="-1"></a>    <span class="at">pos =</span> <span class="fu">factor</span>(pos),</span>
<span id="cb14-26"><a href="baypass-les-résultats.html#cb14-26" tabindex="-1"></a>    <span class="at">PC =</span> SVD_omega<span class="sc">$</span>PC,    <span class="co"># the first eigenvector</span></span>
<span id="cb14-27"><a href="baypass-les-résultats.html#cb14-27" tabindex="-1"></a>    <span class="at">eig =</span> SVD_omega<span class="sc">$</span>eig,    <span class="co"># the second eigenvector</span></span>
<span id="cb14-28"><a href="baypass-les-résultats.html#cb14-28" tabindex="-1"></a>    <span class="at">VAR =</span> SVD_omega<span class="sc">$</span>pcent.var,    <span class="co"># variance proportion for each principal component</span></span>
<span id="cb14-29"><a href="baypass-les-résultats.html#cb14-29" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-30"><a href="baypass-les-résultats.html#cb14-30" tabindex="-1"></a></span>
<span id="cb14-31"><a href="baypass-les-résultats.html#cb14-31" tabindex="-1"></a>ggplot_svd <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tab_SVD, <span class="fu">aes</span>(<span class="at">x=</span>PC<span class="fl">.1</span>, <span class="at">y=</span>PC<span class="fl">.2</span>, <span class="at">shape=</span>phenotype)) <span class="sc">+</span></span>
<span id="cb14-32"><a href="baypass-les-résultats.html#cb14-32" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span> region),<span class="at">alpha=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb14-33"><a href="baypass-les-résultats.html#cb14-33" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Susceptible&#39;</span><span class="ot">=</span><span class="dv">79</span>, <span class="st">&#39;Resistant&#39;</span><span class="ot">=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb14-34"><a href="baypass-les-résultats.html#cb14-34" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">&quot;region&quot;</span>,<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;NO&quot;</span>, <span class="st">&quot;SE&quot;</span>, <span class="st">&quot;SO&quot;</span>),</span>
<span id="cb14-35"><a href="baypass-les-résultats.html#cb14-35" tabindex="-1"></a>                      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#7030a0&quot;</span>, <span class="st">&quot;#00b0f0&quot;</span>, <span class="st">&quot;#ffc100&quot;</span>,<span class="st">&quot;#69ff27&quot;</span> ),</span>
<span id="cb14-36"><a href="baypass-les-résultats.html#cb14-36" tabindex="-1"></a>                      <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">pch=</span><span class="dv">126</span>)))<span class="sc">+</span></span>
<span id="cb14-37"><a href="baypass-les-résultats.html#cb14-37" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Singular Value Decomposition of the covariance (&quot;</span>,<span class="fu">expression</span>(<span class="st">&quot;\U03A9&quot;</span>),<span class="st">&quot;) matrix for Z chromosome&quot;</span>))</span>
<span id="cb14-38"><a href="baypass-les-résultats.html#cb14-38" tabindex="-1"></a></span>
<span id="cb14-39"><a href="baypass-les-résultats.html#cb14-39" tabindex="-1"></a>ggplot_svd <span class="sc">+</span></span>
<span id="cb14-40"><a href="baypass-les-résultats.html#cb14-40" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>()<span class="sc">+</span></span>
<span id="cb14-41"><a href="baypass-les-résultats.html#cb14-41" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>()<span class="sc">+</span></span>
<span id="cb14-42"><a href="baypass-les-résultats.html#cb14-42" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">paste</span>(<span class="st">&quot;PC1 (&quot;</span>,<span class="fu">round</span>(tab_SVD<span class="sc">$</span>VAR[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&quot;%)&quot;</span> , <span class="at">sep=</span><span class="st">&quot;&quot;</span>))<span class="sc">+</span></span>
<span id="cb14-43"><a href="baypass-les-résultats.html#cb14-43" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">paste</span>(<span class="st">&quot;PC2 (&quot;</span>, <span class="fu">round</span>(tab_SVD<span class="sc">$</span>VAR[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&quot;%)&quot;</span> , <span class="at">sep=</span><span class="st">&quot;&quot;</span>))<span class="sc">+</span></span>
<span id="cb14-44"><a href="baypass-les-résultats.html#cb14-44" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> nomsLeft), <span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.05</span>,<span class="at">fontface =</span> <span class="st">&#39;bold&#39;</span>)<span class="sc">+</span></span>
<span id="cb14-45"><a href="baypass-les-résultats.html#cb14-45" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> nomsUp), <span class="at">nudge_y =</span> <span class="fl">0.04</span>,<span class="at">fontface =</span> <span class="st">&#39;bold&#39;</span>)<span class="sc">+</span></span>
<span id="cb14-46"><a href="baypass-les-résultats.html#cb14-46" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> nomsRight), <span class="at">nudge_x =</span> <span class="fl">0.05</span>,<span class="at">fontface =</span> <span class="st">&#39;bold&#39;</span>)<span class="sc">+</span></span>
<span id="cb14-47"><a href="baypass-les-résultats.html#cb14-47" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> nomsN1), <span class="at">nudge_x =</span> <span class="fl">0.03</span>, <span class="at">nudge_y =</span> <span class="fl">0.03</span>, <span class="at">fontface =</span> <span class="st">&#39;bold&#39;</span>)<span class="sc">+</span></span>
<span id="cb14-48"><a href="baypass-les-résultats.html#cb14-48" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> nomsN2), <span class="at">nudge_x =</span> <span class="fl">0.05</span>, <span class="at">nudge_y =</span> <span class="fl">0.00</span>, <span class="at">fontface =</span> <span class="st">&#39;bold&#39;</span>)<span class="sc">+</span></span>
<span id="cb14-49"><a href="baypass-les-résultats.html#cb14-49" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> nomsN3), <span class="at">nudge_x =</span> <span class="fl">0.03</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">0.03</span>, <span class="at">fontface =</span> <span class="st">&#39;bold&#39;</span>)<span class="sc">+</span></span>
<span id="cb14-50"><a href="baypass-les-résultats.html#cb14-50" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">15</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))<span class="sc">+</span></span>
<span id="cb14-51"><a href="baypass-les-résultats.html#cb14-51" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">15</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="An3" class="section level2 unnumbered hasAnchor">
<h2>Annexe 3<a href="baypass-les-résultats.html#An3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="concaténages-des-résultats-betai-et-contrastes." class="section level3 hasAnchor" number="0.0.2">
<h3><span class="header-section-number">0.0.2</span> Concaténages des résultats Betai et contrastes.<a href="baypass-les-résultats.html#concaténages-des-résultats-betai-et-contrastes." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Valable pour le modèle standard pour Betai et pour les 3 modèles pour contraste.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="baypass-les-résultats.html#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="baypass-les-résultats.html#cb15-2" tabindex="-1"></a><span class="va">Snpdet_path</span><span class="op">=</span><span class="st">&#39;/../BayPass/Input/&#39;</span></span>
<span id="cb15-3"><a href="baypass-les-résultats.html#cb15-3" tabindex="-1"></a><span class="va">My_prefix</span><span class="op">=</span><span class="st">&#39;project_STD.sub&#39;</span></span>
<span id="cb15-4"><a href="baypass-les-résultats.html#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="baypass-les-résultats.html#cb15-5" tabindex="-1"></a><span class="co">#on boucle sur toutes les covariables ou combinaisons de contraste</span></span>
<span id="cb15-6"><a href="baypass-les-résultats.html#cb15-6" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">3</span><span class="dt">}</span></span>
<span id="cb15-7"><a href="baypass-les-résultats.html#cb15-7" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb15-8"><a href="baypass-les-résultats.html#cb15-8" tabindex="-1"></a><span class="co">#on boucle sur tous les fichiers</span></span>
<span id="cb15-9"><a href="baypass-les-résultats.html#cb15-9" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">5</span><span class="dt">}</span></span>
<span id="cb15-10"><a href="baypass-les-résultats.html#cb15-10" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb15-11"><a href="baypass-les-résultats.html#cb15-11" tabindex="-1"></a><span class="va">file1</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$Snpdet_path</span><span class="st">/snpdet.sub&quot;&quot;</span><span class="va">$i</span><span class="st">&quot;&quot;&quot;</span><span class="va">)</span></span>
<span id="cb15-12"><a href="baypass-les-résultats.html#cb15-12" tabindex="-1"></a><span class="va">file2</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$My_prefix</span><span class="st">&quot;&quot;</span><span class="va">$i</span><span class="st">&quot;&quot;_summary_betai_reg.out&quot;</span><span class="va">)</span>                          <span class="co">#adapter le préfixe</span></span>
<span id="cb15-13"><a href="baypass-les-résultats.html#cb15-13" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&quot;s/[[:space:]]\+/ /g&quot;</span> <span class="va">$file1</span> <span class="op">&gt;</span> SubSNP.b                                  <span class="co">#on remplace tous les séparateurs par tabulation, ça évite les bugs</span></span>
<span id="cb15-14"><a href="baypass-les-résultats.html#cb15-14" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&quot;s/[[:space:]]\+/ /g&quot;</span> <span class="va">$file2</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-vK</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$k</span><span class="st">&quot;</span> <span class="st">&#39;{if($1 == K) {print}}&#39;</span> <span class="at">-</span> <span class="op">&gt;</span> SubData.b                <span class="co">#on prend si col 1 (covariable) = k</span></span>
<span id="cb15-15"><a href="baypass-les-résultats.html#cb15-15" tabindex="-1"></a><span class="fu">paste</span> SubSNP.b SubData.b <span class="op">&gt;&gt;</span> tmp-Cov<span class="va">$k</span>.merged                            <span class="co">#on colle/incrémente dans un nouveau fichier</span></span>
<span id="cb15-16"><a href="baypass-les-résultats.html#cb15-16" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb15-17"><a href="baypass-les-résultats.html#cb15-17" tabindex="-1"></a><span class="co">#on tri par pos et on reconstruit l&#39;entête</span></span>
<span id="cb15-18"><a href="baypass-les-résultats.html#cb15-18" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&#39;{for (i=1;i&lt;=NF;i++) if ($i+0 == $i &amp;&amp; $i ~ /e/) $2 = sprintf(&quot;%.0f&quot;, $i)} 1&#39;</span> tmp-Cov<span class="va">$k</span>.merged <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-k1,1</span> <span class="at">-k2,2n</span> <span class="at">-</span> <span class="op">&gt;</span> project_Betai.Cov<span class="va">$k</span>     </span>
<span id="cb15-19"><a href="baypass-les-résultats.html#cb15-19" tabindex="-1"></a></span>
<span id="cb15-20"><a href="baypass-les-résultats.html#cb15-20" tabindex="-1"></a><span class="co">#on vire les fichiers tmp</span></span>
<span id="cb15-21"><a href="baypass-les-résultats.html#cb15-21" tabindex="-1"></a><span class="fu">rm</span> tmp-Cov<span class="va">$k</span>.merged</span>
<span id="cb15-22"><a href="baypass-les-résultats.html#cb15-22" tabindex="-1"></a><span class="fu">rm</span> SubSNP.b</span>
<span id="cb15-23"><a href="baypass-les-résultats.html#cb15-23" tabindex="-1"></a><span class="fu">rm</span> SubData.b</span>
<span id="cb15-24"><a href="baypass-les-résultats.html#cb15-24" tabindex="-1"></a></span>
<span id="cb15-25"><a href="baypass-les-résultats.html#cb15-25" tabindex="-1"></a><span class="co">#entête pour les résultats Betai:</span></span>
<span id="cb15-26"><a href="baypass-les-résultats.html#cb15-26" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;1i chr pos All1 All2 COVARIABLE MRK M_Pearson SD_Pearson M_Spearman SD_Spearman BF(dB) Beta_is SD_Beta_is eBPis&#39;</span> project_Betai.Cov<span class="va">$k</span> </span>
<span id="cb15-27"><a href="baypass-les-résultats.html#cb15-27" tabindex="-1"></a></span>
<span id="cb15-28"><a href="baypass-les-résultats.html#cb15-28" tabindex="-1"></a><span class="co">#entête pour les résultats de contraste:</span></span>
<span id="cb15-29"><a href="baypass-les-résultats.html#cb15-29" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;1i chr pos All1 All2 CONTRAST MRK M_C2 SD_C2 C2_std C2_log10(1/pval)&#39;</span> project_contrast-C<span class="va">$k</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="baypass-lanalyse-poolseq.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="références.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/10-Annexes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BayPass_Fr.pdf", "BayPass_Fr.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
