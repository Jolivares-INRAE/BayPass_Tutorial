[["index.html", "BayPass 2.3: tutoriel de génomique dassociation adapté au séquençage en pool Résumé prérequis", " BayPass 2.3: tutoriel de génomique dassociation adapté au séquençage en pool Jérôme OLIVARES1 2023-06-21 Résumé Ce tutoriel détaille dune part la manière de générer les fichiers dentrées du logiciel BayPass à partir de données de séquençage en pool, dautre part le paramétrage optimal du logiciel BayPass et en fin propose une méthode dexploreration des résultats danalyses produits. Un pipeline danalyse mixant des packages sous Rstudio et des lignes de commandes Linux, est décrit afin de guider pas à pas lutilisateur tout au long du processus depuis les données brutes jusquà la liste finale de loci/variants candidats. Ce tutoriel est à destination des étudiants et des bioinformaticiens débutants. mots clefs Logiciel BayPass, séquençage en pool, GWAS, études dassociations pangénomiques, Rstudio. prérequis Les commandes décrites dans cet article ont été regroupées dans un fichier au format « R markdown » (Rmd) « Poolseq_pipeline.Rmd » librement téléchargeable à ladresse : https://github.com/Jolivares-INRAE/Download. Ce tutoriel est conçu pour décrire pas à pas les différentes étapes du fichier Rmd et permettre à lutilisateur de les exécuter en parallèle. Lutilisateur devra avoir une connaissance basique du logiciel Rstudio et être capable décrire et lancer des scripts sur un cluster de calcul. Les commandes ont été rédigées sous Rstudio version 1.4.1106 couplé à R 64 bits version 4.0.5. avec toutes les librairies nécessaires à jour (Capture 1) et dans lenvironnement bash/SLURM des clusters de calculs de la plateforme GenoToul de bioinformatique (GenoToul Bioinfo ). Dans le cas dune utilisation dans un autre environnement logiciel, lutilisateur devra probablement effectuer des adaptations du code. Bien que lessentiel des calculs de BayPass seront réalisés sur un cluster de calcul, certains de ses utilitaires seront utilisés en local sous Rstudio, la dernière version du logiciel sera donc téléchargée depuis ladresse http://www1.montpellier.inra.fr/CBGP/software/baypass/download.html et décompressée dans un répertoire local par lutilisateur. Dans tous les codes qui suivent lexpression « ~/path/ » sera à remplacer par les chemins personnels de lutilisateur. Le terme de chromosome sera utilisé en références aux appellations de contigs, scaffold, ou chromosomes qui correspondent aux séquences nucléotidiques du génome de référence, plus ou moins mature, qui sera utilisé. INRAE, UR-1115 PSH, 228 route de laérodrome, 84914 Avignon, France "],["introduction.html", "Introduction", " Introduction Dans un contexte agronomique actuel de réduction de lutilisation des pesticides ou de réchauffement climatique, analyser et comprendre les bases génétiques de ladaptation des organismes aux méthodes de luttes qui leurs sont opposées ou à lévolution de leur environnement est un enjeu majeur des recherches de ces dernières années. Les études dassociations pangénomiques (GWAS en anglais pour genome-wide association study) adossées aux techniques de séquençage haut débit (NGS) permettant le séquençage de génome complet, sont un outil de choix pour ce type danalyse. Létude au niveau populationnel demandant le séquençage dun grand nombre dindividus, les couts danalyses étaient initialement très élevés et ces études étaient souvent réservées aux organismes dit modèles, humain en tête. Néanmoins il a été démontré depuis, que le séquençage en pool dindividus (poolseq) cest-à-dire en mélangeant de manière équimolaire lADN dun grand nombre dindividus (50 à 100) issus dune même population permettait non seulement de réduire drastiquement les couts puisquon ne réalise quun seul séquençage mais aussi que la découverte des points de mutations (SNP) et lestimation de leur fréquence allélique étaient souvent plus efficaces et précises (Futschik and Schlötterer 2010). Parmi les logiciels à même danalyser ces fréquences alléliques on compte Baypass (Gautier 2015) qui évalue par une approche baysienne, la différenciation des SNP en liaison avec une covariable environnementale en tenant compte de la structure et de la parenté entre les populations en estimant la covariance () des fréquences alléliques. Baypass 2.3 a la particularité supplémentaire de pouvoir calculer un contraste des fréquences alléliques entre deux groupes de populations caractérisés par un caractère binaire, sensible ou résistant par exemple. La documentation disponible de BayPass 2.3 décrit par le menu les algorithmes de fonctionnement et les différents paramètres du logiciel mais reste néanmoins, et assez logiquement, succincte sur les étapes en amont et en aval. A ma connaissance un seul tutoriel est disponible sur le web (Nielsen 2020) et décrit de manière plus détaillée la préparation des données brutes et lanalyse en mode « poolseq » de Baypass, mais il nécessite des bases quelque peu avancées de codage sous R et en environnement bash. Si les bio-informaticiens chevronnés ne rencontreront pas de difficultés particulières, il nen va pas forcément de même pour bon nombre dagents que les orientations des recherches associées à la baisse des coûts de séquençage ont aiguillé vers les voies de la génomique. Cet article a pour but de détailler les différentes étapes dune analyse de type GWAS/poolseq avec le logiciel BayPass 2.3 et déclairer les points qui sont habituellement peu explicités car considérés comme évident et se veut, au final, le plus proche possible de la citation de Talleyrand : « Si cela va sans le dire, cela ira encore mieux en le disant ». "],["présentation-du-logiciel-baypass-2.html", "Présentation du logiciel BayPass 2.3 Présentation générale de lanalyse :", " Présentation du logiciel BayPass 2.3 Le logiciel BayPass est un logiciel de génomique des populations qui vise principalement à lidentification de marqueurs génétiques soumis à la sélection et/ou associés à des covariables spécifiques à la population (variables environnementales, phénotypiques, quantitatives, catégorielles). Par une approche baysienne il évalue une matrice  de covariance des fréquences alléliques des populations résultant de leur histoire démographique. Deux manières destimer ces fréquences alléliques sont disponibles soit en se basant sur les génotypes référence/mutant des individus analysés soit, lorsque lon active le « pool-seq mode », ces fréquences alléliques sont calculées en regard de la profondeur de séquençage (reads count) et pondérées par le nombre dindividus qui ont contribué à cette profondeur. Cest cette seconde approche que nous considérerons dans cet ouvrage. BayPass propose 3 modèles statistiques danalyse : Le Core Model Cest le modèle de base, il permet de calculer la matrice de covariance  et dattribuer une statistique de différenciation XtX à chaque SNP, et ainsi de scanner le génome pour identifier les régions génomiques différenciées entre les populations.Le XtX est une statistique analogue au Fst mais tient compte de la co-évolution des populations grace à la matrice . Le Standard Model Ce modèle, permet, lorsque lon fournit une ou plusieurs covariables (environnementales, phénotypiques), de calculer un facteur de Bayes, ou Bayes factor en anglais, (BF) pour chaque marqueur génétique représentant la force dassociation avec une covariable. Cest un modèle tout en un qui intègre le calcul des XtX et de la matrice , il est adapté au faible nombre de population (&lt; 15). LAuxiliairy Model Ce modèle a une approche différente dans le calcul de la statistique BF, sans entrer dans le détail il est plus adapté au grand nombre de population (&gt; 15), En contrepartie il nécessite que lon fournisse une matrice  déjà calculée par une analyse Core Model précédente, il recalcule alors les XtX et la statistique BF. Ces covariables évoquées doivent être distribuées en gradient entre les populations (différence de température, daltitude), en complément, dans le cas où la covariable étudiée serait purement binaire (sensible/résistant, gros/petit), les modèles Standard et Auxiliaire peuvent calculer une statistique C2 qui évalue le contraste de différence des fréquences alléliques de chaque marqueur entre 2 groupes de populations. Présentation générale de lanalyse : La \\(\\ref{fig:Fig1}{&quot;Figure 1&quot;}\\) est une vision simplifiée des différentes étapes nécessaire à lanalyses de données poolseq. Ces étapes se déroulent soit dans lenvironnement Linux du cluster de calcul soit sur un ordinateur local sous Rstudio. La première étape part dun fichier dalignement au format « .bam » et consiste à effectuer une recherche de variants (variant calling) pour obtenir un fichier au format « .vcf » de tous les points de mutations ou SNP qui sont autant de marqueurs génétiques à analyser. Ce fichier .vcf sert dentrée au package « PoolFstat » qui va permettre de générer les fichiers nécessaires au bon fonctionnement de BayPass mais aussi de faire une première analyse des Fst entre populations par exemple. Ces fichiers dentrées pouvant contenir plusieurs millions de SNP, ils sont découpés en plusieurs dizaines de sous jeux de données afin de réduire les temps de calculs. Une fois que BayPass a analysé tous les sous jeux de données, lhomogénéité des résultats entre eux est analysée sous Rstudio et si tout est bon, les résultats peuvent être regroupés, filtrés et analysés afin de déterminer les marqueurs génétiques et les régions chromosomiques dintérêts. knitr::include_graphics(&quot;C:/Users/Olivares/Documents/R/Git_Work/BayPass_Tutorial/images/Analyse.jpg&quot;) Figure 1: Pipeline danalyses BayPass "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
